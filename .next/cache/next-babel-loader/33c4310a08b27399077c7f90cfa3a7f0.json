{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\n\nclass PreviewBar extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n    this.handleAddedHtml = this.handleAddedHtml.bind(this);\n  }\n\n  handleAddedHtml(userInp) {\n    // if 'link-container' class exists, have a fixed height, hide overflows and alternate the inner content;\n    let tagExp = /<\\/(\\w+)>/g;\n    let tagNProps = /<(\\w+[-'\"=\\s(\\w)\\:]*)>/g;\n    let re, tagWhole;\n    let tagArr = [],\n        tagWhArr = [];\n    let classes = userInp.match(/class=\"([-\\w\\s]+)\"/);\n    let containerLinkStyle = {};\n\n    while (re = tagExp.exec(userInp)) {\n      tagArr.push(re[1]);\n      if (!re) break;\n    }\n\n    while (tagWhole = tagNProps.exec(userInp)) {\n      tagWhArr.push(tagWhole[1]);\n      if (!tagWhole) break;\n    }\n\n    console.log(tagWhArr); // to parse tagWhArr, make it an array of objects containing tag, prop and children\n\n    tagWhArr.map((item, idx) => {\n      let result,\n          propArr = [],\n          props,\n          propExp = /([-\\w]+)=\"(.*)\"/g,\n          tagExp = /(\\w+)[\\s]+/;\n      console.log('this tag', item.match(tagExp)); // if item.match(tagExp) is null, then tag is item, otherwise, tag is item.match(tagExp)[1]\n\n      result.tag = !item.match(tagExp) ? item : item.match(tagExp)[1];\n      console.log('result tag', result); // [1] is attribute name, [2] is attribute value;\n\n      while (props = propExp.exec(item)) {\n        propArr.push({\n          propertyName: props[1],\n          propertyValue: props[2]\n        });\n        if (!props) break;\n      }\n\n      ;\n      result.properties = propArr;\n      console.log('result props');\n    });\n\n    if (classes) {\n      classes = classes[1].split(' ');\n\n      if (classes.includes('container-link')) {\n        containerLinkStyle = {\n          height: '22px',\n          overflow: 'hidden'\n        };\n      }\n    }\n\n    if (userInp) {\n      let prop = {}; // if(tag==='a'){\n      //   prop['href']='https://wwww.baidu.com'\n      //   prop['style']={display:'block',color:'#fff'}\n      // }\n\n      for (let n = 0; n < tagArr.length; n++) {\n        switch (tagArr[n]) {\n          case 'a':\n            prop['href'] = '';\n            break;\n        }\n\n        return React.createElement(tagArr[n], prop, 'any text');\n      }\n    }\n  }\n\n  render() {\n    const {\n      bgColor,\n      ftColor\n    } = this.props.barConfig;\n    return __jsx(\"div\", {\n      style: {\n        margin: '20px 0'\n      }\n    }, __jsx(\"div\", {\n      style: {\n        padding: '8px 0',\n        position: 'relative',\n        backgroundColor: bgColor,\n        color: ftColor\n      }\n    }, this.props.barConfig.goal ? this.props.barConfig.inpTxt + '$' + this.props.barConfig.goal : this.props.barConfig.inpTxt, this.props.barConfig.addedHtml ? this.handleAddedHtml(this.props.barConfig.addedHtml) : null, __jsx(\"div\", {\n      style: {\n        position: 'absolute',\n        top: '8px',\n        right: '8px'\n      }\n    }, \"X\")));\n  }\n\n}\n\nexport default PreviewBar;","map":{"version":3,"sources":["C:\\Users\\Administrator.SC-201903211547\\projects\\0919\\sample-embedded-app\\snippets\\previewBar.js"],"names":["PreviewBar","React","Component","constructor","props","state","handleAddedHtml","bind","userInp","tagExp","tagNProps","re","tagWhole","tagArr","tagWhArr","classes","match","containerLinkStyle","exec","push","console","log","map","item","idx","result","propArr","propExp","tag","propertyName","propertyValue","properties","split","includes","height","overflow","prop","n","length","createElement","render","bgColor","ftColor","barConfig","margin","padding","position","backgroundColor","color","goal","inpTxt","addedHtml","top","right"],"mappings":"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","sourcesContent":["\r\nclass PreviewBar extends React.Component{\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {}\r\n    this.handleAddedHtml = this.handleAddedHtml.bind(this);\r\n  }\r\n\r\n  handleAddedHtml(userInp){\r\n    // if 'link-container' class exists, have a fixed height, hide overflows and alternate the inner content;\r\n    let tagExp = /<\\/(\\w+)>/g;\r\n    let tagNProps = /<(\\w+[-'\"=\\s(\\w)\\:]*)>/g;\r\n    let re, tagWhole ;\r\n    let tagArr = [],tagWhArr=[];\r\n    let classes = userInp.match(/class=\"([-\\w\\s]+)\"/);\r\n    let containerLinkStyle = {};\r\n    while(re= tagExp.exec(userInp)){\r\n      tagArr.push(re[1]);\r\n      if(!re) break;\r\n    }\r\n    while(tagWhole = tagNProps.exec(userInp)){\r\n      tagWhArr.push(tagWhole[1]);\r\n      if(!tagWhole) break;\r\n    }\r\n    console.log(tagWhArr);\r\n    // to parse tagWhArr, make it an array of objects containing tag, prop and children\r\n    tagWhArr.map((item,idx)=>{\r\n      let result,propArr=[], props,propExp=/([-\\w]+)=\"(.*)\"/g,tagExp=/(\\w+)[\\s]+/;\r\n      console.log('this tag',item.match(tagExp));\r\n      // if item.match(tagExp) is null, then tag is item, otherwise, tag is item.match(tagExp)[1]\r\n      result.tag = !item.match(tagExp)? item : item.match(tagExp)[1];\r\n      console.log('result tag',result); \r\n      // [1] is attribute name, [2] is attribute value;\r\n      while(props = propExp.exec(item)){\r\n        propArr.push({propertyName:props[1],propertyValue:props[2]});\r\n        if(!props) break;\r\n      };\r\n      result.properties = propArr;\r\n      console.log('result props');\r\n    })\r\n    if(classes){\r\n      classes = classes[1].split(' ');\r\n      if(classes.includes('container-link')){\r\n        containerLinkStyle = {height:'22px',overflow:'hidden'}\r\n      }\r\n    }\r\n    if(userInp) {\r\n      let prop={};\r\n      // if(tag==='a'){\r\n      //   prop['href']='https://wwww.baidu.com'\r\n      //   prop['style']={display:'block',color:'#fff'}\r\n      // }\r\n      for(let n=0;n<tagArr.length;n++){\r\n        switch(tagArr[n]){\r\n          case 'a':\r\n            prop['href']='';\r\n            break;\r\n        \r\n\r\n        }\r\n        return React.createElement(tagArr[n],prop,'any text')\r\n      }\r\n    } \r\n  }\r\n\r\n  render(){\r\n    const {bgColor, ftColor } = this.props.barConfig;\r\n    return (\r\n      <div style={{margin:'20px 0'}}>\r\n        <div style={{padding:'8px 0',position:'relative',backgroundColor:bgColor,color:ftColor}}>\r\n          { this.props.barConfig.goal?\r\n            this.props.barConfig.inpTxt + '$' + this.props.barConfig.goal\r\n            :\r\n            this.props.barConfig.inpTxt\r\n          }\r\n          {/* #question: how to turn user input into raw html */}\r\n          { this.props.barConfig.addedHtml?\r\n              this.handleAddedHtml(this.props.barConfig.addedHtml) \r\n              :\r\n              null\r\n          }\r\n          <div style={{position:'absolute',top:'8px',right:'8px'}}>X</div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default PreviewBar;"]},"metadata":{},"sourceType":"module"}